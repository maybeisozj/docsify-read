# 简单工厂模式

## 概念

### 定义

工厂模式是一种创建型模式，它定义一个创建产品的工产接口，将产品对象的实际创建推迟到具体子工厂类中实现，达到了**“创建与使用相分离”**的特点。

在开发中，凡是需要生成复杂对象的地方，都可以尝试考虑使用工厂模式来代替。

> 注意：上述复杂对象指的是类的构造函数参数过多等对类的构造有影响的情况，因为类的构造过于复杂，如果直接在其他业务类内使用，则两者的耦合过重，后续业务更改，就需要在任何引用该类的源代码内进行更改，光是查找所有依赖就很消耗时间了，更别说要一个一个修改了。

我们把被创建的对象称为“产品”，把创建产品的对象称为“工厂”。如果要创建的产品不多，只要一个工厂类就可以完成，这种模式叫“简单工厂模式”。

在简单工厂模式中创建实例的方法通常为静态（static）方法，因此简单工厂模式（Simple Factory Pattern）又叫作静态工厂方法模式（Static Factory Method Pattern）。

### 特点

1. 创建与使用相分离，在工厂里创建，调用者不需要管这个过程；
2. 每添加一个产品就要添加一个具体产品类和对应的具体工厂类，增加了系统复杂度；

## 结构和实现

### 结构



模式结构图如下：

![image-20200919094748949](https://i.loli.net/2020/09/19/ai54EFcAPIDR9x8.png)

观察结构图，我们可以得出，主要角色有：

简单工厂：简单工厂模式的核心，负责实现创建所有实例的内部逻辑。

抽象产品：负责描述所有实例共有的公共接口。

具体产品：是简单工厂模式的创建目标。

### 实现

主要的还是简单工厂里的逻辑处理吧，看下面，其他的就自己处理一下这样子。

```java
public class SimpleFactory {
    public Product makeProduct(int type) {
        switch(type) {
            case 1:
                return new ConcreteProduct1();
            case 2:
                return new ConcreteProduct2();
            default:
                return null;
        }
    }
}
```

Client 调用的话就是下面这样子：

```java
public class Client {
    public static void main (String[] args) {
        SimpleFactory simpleFactory = new SimpleFactory();
        
        Product product1 = simpleFactory.makeProduct(1);
        product1.show();
        
        Product product2 = simpleFactory.makeProduct(2);
        product2.show();
    }
}
```



## 模式的优点和缺点

模式的优点：

- 一个调用者想创建一个对象，只要**知道其名称**就可以了。
- **屏蔽产品的具体实现**，调用者只关心产品的接口。工厂和产品的职责区分明确。


模式的缺点：

- 简单工厂模式的工厂类单一，负责所有产品的创建，**职责过重**，一旦异常，整个系统将受影响。且工厂类代码会非常臃肿，违背高聚合原则。
- 系统扩展困难，一旦增加新产品不得不修改工厂逻辑，在产品类型较多时，可能造成**逻辑过于复杂**。

## 模式的应用场景



1、日志记录器：记录可能记录到本地硬盘、系统事件、远程服务器等，用户可以选择记录日志到什么地方。 

2、数据库访问，当用户不知道最后系统采用哪一类数据库，以及数据库可能有变化时。 

3、设计一个连接服务器的框架，需要三个协议，"POP3"、"IMAP"、"HTTP"，可以把这三个作为产品类，共同实现一个接口。